{% extends 'layout.html' %}
{% block content %}
<!-- ############ PAGE START-->
<div class="padding">
  <div class="box">
    <div class="box-header">
      <h3>{{subtitle}}</h3>
    </div>
    <div class="box-body">
      <div class="row p-a">
        <div class="col-sm-5">
          <a href="#" data-toggle="modal" data-target="#project-modal" class="btn btn-outline b-primary text-primary" data-backdrop="static">Add New Project</a>
        </div>
      </div>
      <div class="table-responsive">
        <table id="projects-overview" class="table table-striped b-t b-b" ui-jp="dataTable">
          <thead>
          <tr>
            <th style="width:20px;" data-sort-ignore="true"></th>
            <th>Project Nr</th>
            <th>Community</th>
            <th>Street</th>
            <th>House Nr</th>
            <th>Finished/All</th>
            <th data-sort-ignore="true">Project Types</th>
            <th style="width:20px;" data-sort-ignore="true"></th>
            <th style="width:20px;" data-sort-ignore="true"></th>
          </tr>
          </thead>
          <tbody>
          {% for project in projects %}
          <tr>
            <td class="details-control"></td>
            <td>{{project.id}}</td>
            <td>{{project.community}}</td>
            <td>{{project.street}}</td>
            <td>{{project.housenr}}</td>
            <td>{{project.contracts_status}}</td>
            <td>
              <div class="row">
                {% if project.contract_types.electric %}
                <span class="col-md-1 label label-lg red-500" style="border-style: solid">E</span>
                {% else %}
                <span class="col-md-1 label label-lg" style="border-style: solid">E</span>
                {% endif %}

                {% if project.contract_types.water %}
                <span class="col-md-1 label label-lg green-500" style="border-style: solid">W</span>
                {% else %}
                  <span class="col-md-1 label label-lg" style="border-style: solid">W</span>
                {% endif %}

                {% if project.contract_types.light %}
                  <span class="col-md-1 label label-lg blue-500" style="border-style: solid">B</span>
                {% else %}
                  <span class="col-md-1 label label-lg" style="border-style: solid">B</span>
                {% endif %}

                {% if project.contract_types.telecom %}
                <span class="col-md-1 label label-lg orange-500" style="border-style: solid">T</span>
                {% else %}
                <span class="col-md-1 label label-lg" style="border-style: solid">T</span>
                {% endif %}

                {% if project.contract_types.gas %}
                 <span class="col-md-1 label label-lg yellow-500" style="border-style: solid">G</span>
                {% else %}
                  <span class="col-md-1 label label-lg" style="border-style: solid">G</span>
                {% endif %}

                {% if project.contract_types.others %}
                 <span class="col-md-1 label label-lg blue-grey-500" style="border-style: solid">S</span>
                {% else %}
                  <span class="col-md-1 label label-lg" style="border-style: solid">S</span>
                {% endif %}
              </div>
            </td>
            <td>
              <a href="#" data-toggle="modal" data-target="#contract-basic-modal" data-project="{{project|json}}"><i class="material-icons md-24">&#xe146;</i></a>
            </td>
            <td>
              <a href="#" data-toggle="modal" data-target="#project-modal" data-project="{{project|json}}"><i class="material-icons md-24">&#xe3c9;</i></a>
            </td>
          </tr>
          {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>


<!-- add and edit project modal -->
{% include 'modal_project.html' %}

<!-- add and edit contract basic modal -->
{% include 'modal_contract_basic.html' %}

<!-- add and edit contract basic modal -->
{% include 'modal_contract_building_permissions.html' %}

<!-- add and edit contract basic modal -->
{% include 'modal_contract_building.html' %}

<!-- add and edit contract basic modal -->
{% include 'modal_contract_ofw.html' %}

<!-- add and edit contract basic modal -->
{% include 'modal_contract_invoices.html' %}


<iframe id="file_tobe_printed" src="" hidden></iframe>

<!-- / .modal -->
<!-- ############ PAGE END-->

<script type="text/javascript">
    $.getScript(  '/scripts/app_com.js', function() {
        console.log('laod app_com');
    });

    $.getScript(  '/scripts/app_project.js', function() {
        console.log('laod app_project');
    });

    $.getScript(  '/scripts/app_contract.js', function() {
        console.log('laod app_contract');
    });

    $(function(){
        var $p = $($(".progress")[0]);
        $p.on( "sliderchange", function(e,result){
            $('#building_progress_bar').html(result.value);
            alert('111');
        });
    });

function postContractEditPartial (id, data, callback){
  url = '/contracts/edit/partial/'+id;
  var posting = $.post( url, data );
  posting.done(function( data ) {
    if(data!='ok') {
      let err = 'err';
      callback(err);
    }
    else
      callback(undefined);
  });
}

function printTemplate(id){
  url = '/contracts/print/'+id;
  var posting = $.post( url, {} );
  posting.done(function( data ) { 
    $('#file_tobe_printed').attr('src', data);
    //var iframe = document.getElementById('file_tobe_printed');
    //iframe.contentWindow.print();
    //alert(data);
    return;
    if(data!='ok') {
      let err = 'err';
      callback(err);
    }
    else
      callback(undefined);
  });  
}
</script>
<!-- ############ PAGE END-->
{% endblock %}
